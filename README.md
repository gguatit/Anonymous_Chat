# ìµëª… ì±„íŒ… (Anonymous Chat)

Cloudflare Workersì™€ Pages ê¸°ë°˜ ì‹¤ì‹œê°„ ìµëª… ì±„íŒ… ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜

## ğŸ“‹ ê°œìš”

ì´ í”„ë¡œì íŠ¸ëŠ” ì„œë²„ë¦¬ìŠ¤ ì•„í‚¤í…ì²˜ë¥¼ í™œìš©í•œ ì™„ì „ ìµëª… ì‹¤ì‹œê°„ ì±„íŒ… ì• í”Œë¦¬ì¼€ì´ì…˜ì…ë‹ˆë‹¤. Cloudflare Workersì˜ Durable Objectsë¥¼ ì‚¬ìš©í•˜ì—¬ WebSocket ì—°ê²°ì„ ê´€ë¦¬í•˜ë©°, ëª¨ë“  ë©”ì‹œì§€ëŠ” ë©”ëª¨ë¦¬ì—ë§Œ ì €ì¥ë˜ì–´ ì˜êµ¬ ë³´ì¡´ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

## âœ¨ ì£¼ìš” ê¸°ëŠ¥

### í•µì‹¬ ê¸°ëŠ¥
- âœ… **ì‹¤ì‹œê°„ ì±„íŒ…**: WebSocket ê¸°ë°˜ ì‹¤ì‹œê°„ ë©”ì‹œì§€ ì „ì†¡
- âœ… **ì™„ì „ ìµëª…**: ë‹‰ë„¤ì„ ì—†ì´ ì„¸ì…˜ ê¸°ë°˜ ìµëª… ì²˜ë¦¬
- âœ… **ì„ì‹œ ë©”ì‹œì§€**: ë©”ëª¨ë¦¬ìƒì—ë§Œ ìœ ì§€, ìƒˆë¡œê³ ì¹¨ ì‹œ ì´ˆê¸°í™”
- âœ… **íƒ€ì´í•‘ í‘œì‹œ**: ë‹¤ë¥¸ ì‚¬ìš©ìì˜ íƒ€ì´í•‘ ìƒíƒœ ì‹¤ì‹œê°„ í‘œì‹œ
- âœ… **ì ‘ì†ì ìˆ˜**: ì‹¤ì‹œê°„ í™œì„± ì‚¬ìš©ì ìˆ˜ í‘œì‹œ
- âœ… **íƒ€ì„ìŠ¤íƒ¬í”„**: ëª¨ë“  ë©”ì‹œì§€ì— ì „ì†¡ ì‹œê°„ í‘œì‹œ

### ë³´ì•ˆ ê¸°ëŠ¥
- ğŸ”’ **CSRF ë°©ì§€**: WebSocket ì—°ê²° ë³´ì•ˆ
- ğŸ”’ **ì…ë ¥ ê²€ì¦**: ë©”ì‹œì§€ ë‚´ìš© ë° ê¸¸ì´ ê²€ì¦
- ğŸ”’ **Rate Limiting**: 
  - ë©”ì‹œì§€ ì „ì†¡ ë¹ˆë„ ì œí•œ (1ì´ˆë‹¹ 1ê°œ)
  - ë¶„ë‹¹ ìµœëŒ€ 30ê°œ ë©”ì‹œì§€
  - IPë‹¹ ìµœëŒ€ 5ê°œ ë™ì‹œ ì—°ê²°
- ğŸ”’ **IP ê¸°ë°˜ ì ‘ê·¼ ì œì–´**: ì°¨ë‹¨ ë° í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ì§€ì›
- ğŸ”’ **XSS ë°©ì§€**: ì…ë ¥ ë°ì´í„° sanitization
- ğŸ”’ **ì§€ìˆ˜ì  ë°±ì˜¤í”„**: ì—°ê²° ì¬ì‹œë„ ì‹œ í­ì£¼ ë°©ì§€

### UI/UX
- ğŸ¨ **ë‹¤í¬ í…Œë§ˆ**: ëˆˆì˜ í”¼ë¡œë¥¼ ì¤„ì´ëŠ” ì–´ë‘ìš´ í…Œë§ˆ
- ğŸ“± **ë°˜ì‘í˜• ë””ìì¸**: ëª¨ë°”ì¼, íƒœë¸”ë¦¿, ë°ìŠ¤í¬í†± ì§€ì›
- â™¿ **ì ‘ê·¼ì„±**: ARIA ë ˆì´ë¸” ë° ì‹œë§¨í‹± HTML
- ğŸ¯ **Tailwind CSS**: ìµœì†Œí•œì˜ ì»´í¬ë„ŒíŠ¸ë¡œ êµ¬ì„±ëœ ê¹”ë”í•œ UI

### ëª¨ë‹ˆí„°ë§
- ğŸ“Š **ìµëª… ë©”íŠ¸ë¦­**: ìµœì†Œí•œì˜ ì ‘ì† í†µê³„ ìˆ˜ì§‘
- ğŸ“ˆ **ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§**: ì—°ê²° ìˆ˜, ë©”ì‹œì§€ ìˆ˜ ì¶”ì 
- ğŸ› **ì˜¤ë¥˜ ì¶”ì **: ì—ëŸ¬ ë¡œê¹… ë° ëª¨ë‹ˆí„°ë§

## ğŸ—ï¸ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Browser   â”‚
â”‚  (Client)   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚ WebSocket
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Cloudflare Worker   â”‚
â”‚  (Entry Point)      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Durable Object     â”‚
â”‚   (ChatRoom)        â”‚
â”‚  - Session Mgmt     â”‚
â”‚  - Message Routing  â”‚
â”‚  - Rate Limiting    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Cloudflare Pages    â”‚
â”‚  (Static Assets)    â”‚
â”‚  - HTML/CSS/JS      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ ë¹ ë¥¸ ì‹œì‘

### ì‚¬ì „ ìš”êµ¬ì‚¬í•­

- Node.js 16 ì´ìƒ
- Cloudflare ê³„ì •
- Wrangler CLI

### ì„¤ì¹˜

```bash
# ì €ì¥ì†Œ í´ë¡ 
git clone https://github.com/gguatit/Anonymous_Chat.git
cd Anonymous_Chat

# ì˜ì¡´ì„± ì„¤ì¹˜
npm install

# Wrangler ë¡œê·¸ì¸
wrangler login
```

### ë¡œì»¬ ê°œë°œ

```bash
# ê°œë°œ ì„œë²„ ì‹œì‘
npm run dev

# ë¸Œë¼ìš°ì €ì—ì„œ http://localhost:8787 ì ‘ì†
```

### ë°°í¬

#### ìë™ ë°°í¬ (ê¶Œì¥)
```bash
# ë°°í¬ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
./deploy.sh
```

#### ìˆ˜ë™ ë°°í¬

```bash
# Workerì™€ static assetsë¥¼ í•¨ê»˜ ë°°í¬
npm run deploy
```

ë˜ëŠ” Pagesë§Œ ë³„ë„ ë°°í¬:

```bash
# Pages ë°°í¬
npm run deploy:pages
```

## ğŸ§ª í…ŒìŠ¤íŠ¸

```bash
# í…ŒìŠ¤íŠ¸ ì‹¤í–‰
npm test

# Watch ëª¨ë“œë¡œ í…ŒìŠ¤íŠ¸
npm run test:watch

# ë¦°íŠ¸ ê²€ì‚¬
npm run lint
```

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
Anonymous_Chat/
â”œâ”€â”€ public/              # ì •ì  íŒŒì¼ (Pages/Assetsì— ë°°í¬)
â”‚   â”œâ”€â”€ index.html      # ë©”ì¸ HTML
â”‚   â”œâ”€â”€ app.js          # í´ë¼ì´ì–¸íŠ¸ JavaScript
â”‚   â”œâ”€â”€ _headers        # Cloudflare Pages ë³´ì•ˆ í—¤ë”
â”‚   â””â”€â”€ _redirects      # Cloudflare Pages ë¦¬ë‹¤ì´ë ‰íŠ¸
â”œâ”€â”€ src/                # Worker ì†ŒìŠ¤
â”‚   â””â”€â”€ worker.js       # Worker ë° Durable Object
â”œâ”€â”€ test/               # í…ŒìŠ¤íŠ¸ íŒŒì¼
â”‚   â””â”€â”€ worker.test.js  # Worker í…ŒìŠ¤íŠ¸
â”œâ”€â”€ package.json        # í”„ë¡œì íŠ¸ ì„¤ì •
â”œâ”€â”€ wrangler.toml       # Cloudflare ì„¤ì •
â”œâ”€â”€ vitest.config.js    # Vitest ì„¤ì •
â”œâ”€â”€ deploy.sh           # ë°°í¬ ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ ARCHITECTURE.md     # ì•„í‚¤í…ì²˜ ë¬¸ì„œ
â”œâ”€â”€ DEPLOYMENT.md       # ë°°í¬ ê°€ì´ë“œ
â””â”€â”€ README.md           # ë¬¸ì„œ
```

## âš™ï¸ ì„¤ì •

### í™˜ê²½ ë³€ìˆ˜

`wrangler.toml` ë˜ëŠ” Cloudflare Dashboardì—ì„œ ì„¤ì •:

```toml
[env.production]
vars = { ENVIRONMENT = "production" }
```

### ë³´ì•ˆ ì„¤ì •

`src/worker.js`ì—ì„œ ìˆ˜ì • ê°€ëŠ¥:

```javascript
const RATE_LIMIT = {
    MAX_MESSAGES_PER_MINUTE: 30,
    MAX_CONNECTIONS_PER_IP: 5,
    MESSAGE_COOLDOWN: 1000,
};

const SECURITY = {
    MAX_MESSAGE_LENGTH: 500,
    BANNED_IPS: new Set(['banned.ip.address']),
    IP_WHITELIST: null, // null = ëª¨ë“  IP í—ˆìš©
};
```

## ğŸ“Š API ì—”ë“œí¬ì¸íŠ¸

### WebSocket
- `GET /ws` - WebSocket ì—°ê²°

### HTTP
- `GET /health` - í—¬ìŠ¤ ì²´í¬
- `GET /metrics` - ìµëª…í™”ëœ ë©”íŠ¸ë¦­

## ğŸ”’ ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

1. **ë°ì´í„° ë³´ì¡´**: ë©”ì‹œì§€ëŠ” ë©”ëª¨ë¦¬ì—ë§Œ ì €ì¥ë˜ë©° ì˜êµ¬ ë³´ì¡´ë˜ì§€ ì•ŠìŒ
2. **ìµëª…ì„±**: ì‚¬ìš©ì ì‹ë³„ ì •ë³´ë¥¼ ìˆ˜ì§‘í•˜ì§€ ì•ŠìŒ (ì„¸ì…˜ IDë§Œ ì‚¬ìš©)
3. **Rate Limiting**: ìŠ¤íŒ¸ ë° DoS ê³µê²© ë°©ì§€
4. **ì…ë ¥ ê²€ì¦**: ëª¨ë“  ì‚¬ìš©ì ì…ë ¥ ê²€ì¦ ë° sanitization
5. **IP ê¸°ë°˜ ì œì–´**: ì•…ì˜ì  IP ì°¨ë‹¨ ê¸°ëŠ¥
6. **ì—°ê²° ì œí•œ**: IPë‹¹ ë™ì‹œ ì—°ê²° ìˆ˜ ì œí•œ

## ğŸ“ˆ ëª¨ë‹ˆí„°ë§

### ë©”íŠ¸ë¦­ í™•ì¸

```bash
# Worker ë¡œê·¸ ì‹¤ì‹œê°„ í™•ì¸
wrangler tail

# ë©”íŠ¸ë¦­ API í˜¸ì¶œ
curl https://your-worker.workers.dev/metrics
```

### ì‘ë‹µ ì˜ˆì‹œ
```json
{
  "timestamp": 1699264800000,
  "activeConnections": 5,
  "totalMessages": 1234
}
```

## ğŸ› ï¸ ë¬¸ì œ í•´ê²°

### WebSocket ì—°ê²° ì‹¤íŒ¨
- Cloudflare Workerê°€ WebSocketì„ ì§€ì›í•˜ëŠ”ì§€ í™•ì¸
- Durable Objectsê°€ í™œì„±í™”ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
- ë¸Œë¼ìš°ì € ì½˜ì†”ì—ì„œ ì—ëŸ¬ ë©”ì‹œì§€ í™•ì¸

### ë©”ì‹œì§€ê°€ ì „ì†¡ë˜ì§€ ì•ŠìŒ
- Rate Limiting ì œí•œ í™•ì¸ (1ì´ˆë‹¹ 1ê°œ)
- ë©”ì‹œì§€ ê¸¸ì´ ì œí•œ í™•ì¸ (500ì)
- ë„¤íŠ¸ì›Œí¬ ì—°ê²° ìƒíƒœ í™•ì¸

### ì¬ì—°ê²° ì‹¤íŒ¨
- ìµœëŒ€ ì¬ì—°ê²° ì‹œë„ íšŸìˆ˜(10íšŒ) ì´ˆê³¼ ì—¬ë¶€ í™•ì¸
- í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ ì‹œë„
- Worker ìƒíƒœ í™•ì¸

## ğŸ¤ ê¸°ì—¬

1. Fork the repository
2. Create your feature branch (`git checkout -b feature/AmazingFeature`)
3. Commit your changes (`git commit -m 'Add some AmazingFeature'`)
4. Push to the branch (`git push origin feature/AmazingFeature`)
5. Open a Pull Request

## ğŸ“ ë¼ì´ì„ ìŠ¤

MIT License - ììœ ë¡­ê²Œ ì‚¬ìš©, ìˆ˜ì •, ë°°í¬ ê°€ëŠ¥

## ğŸ™ ê°ì‚¬ì˜ ë§

- Cloudflare Workers & Pages
- Tailwind CSS
- Vitest

## ğŸ“ ì§€ì›

ë¬¸ì œê°€ ë°œìƒí•˜ê±°ë‚˜ ì§ˆë¬¸ì´ ìˆìœ¼ì‹œë©´ GitHub Issuesë¥¼ í†µí•´ ì•Œë ¤ì£¼ì„¸ìš”.

---

**Made with â¤ï¸ using Cloudflare Workers and Pages**